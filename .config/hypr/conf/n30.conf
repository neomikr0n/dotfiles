# ----------------------------------------------------- 
#█▄░█ ▒▄▀▀▄ ▒▄▀▀▄ 
#█░▀█ ░░▒▀▌ ▒█▄▀█ 
#▀░░▀ ▒▀▄▄▀ ▒▀▄▄▀ 

# Be sure to add to the last line of hyprland.conf:
# source = ~/.config/hypr/conf/n30.conf
# ----------------------------------------------------- 
#█▀▀ █▄░█ ▐▌░▐▌ ▀ █▀▀▄ ▄▀▄ █▄░▄█ █▀▀ █▄░█ ▀█▀ ▄▀▄ █░░ 
#█▀▀ █░▀█ ░▀▄▀░ █ █▐█▀ █░█ █░█░█ █▀▀ █░▀█ ░█░ █▀█ █░▄ 
#▀▀▀ ▀░░▀ ░░▀░░ ▀ ▀░▀▀ ░▀░ ▀░░░▀ ▀▀▀ ▀░░▀ ░▀░ ▀░▀ ▀▀▀ 
# ----------------------------------------
monitor=DP-2,3440x1440@240.09,auto,1, bitdepth, 10, cm, srgb

# Claude code...Y agrégalas en este orden específico:
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = /usr/bin/gnome-keyring-daemon --start --components=pkcs11,secrets,ssh

#HDR tho
#monitor=DP-2,3440x1440@240.09,auto,1, bitdepth, 10, cm, auto, sdrbrightness, 1, sdrsaturation, 1

env = QT_QPA_PLATFORMTHEME,kde
env = QT_QPA_PLATFORM,wayland
env = XDG_MENU_PREFIX,plasma-321

env = SDL_VIDEODRIVER,wayland,x11,windows
#env = SDL_VIDEODRIVER,wayland
env = ELECTRON_OZONE_PLATFORM_HINT,wayland

# FOR DEBUGGING:
#env= HYPRLAND_LOG_WLR,1
#env= HYPRLAND_TRACE,1
#env= AQ_TRACE,1

input {
    kb_layout = latam
    kb_variant = 
    follow_mouse = 1
    numlock_by_default = true

    sensitivity = 0 # -1.0 - 1.0, 0 means no modification.
    force_no_accel = 0
}

misc {
    vrr = 0
    allow_session_lock_restore = 1  # for compatibility?
    session_lock_xray = 1           # for video mvpaper + hyprlock?
}

general {
    gaps_in = 0
    gaps_out = 0,0,0,0,
    border_size = 2
    col.active_border = $color11
    col.inactive_border = rgba(255,255,155,0)
}

experimental {
    #wide_color_gamut = true
    xx_color_management_v4 = true
}

debug {
    disable_logs = false
}

render {
    cm_fs_passthrough = 2
}

#  ▐▌░▐▌ ▄▀▄ █▀▀▄ ▀ ▄▀▄ █▀▄ █░░ █▀▀ ▄▀▀ 
#  ▀▄▀░ █▀█ █▐█▀ █ █▀█ █▀█ █░▄ █▀▀ ░▀▄ 
# ░▀░░ ▀░▀ ▀░▀▀ ▀ ▀░▀ ▀▀░ ▀▀▀ ▀▀▀ ▀▀░ 
# ----------------------------------------
#$files= nautilus
$files= dolphin
#$browser= firedragon
$browser= zen-browser
$whatsapp= zapzap
#$music= spotify-adblock
#$music= tidal-hifi
$music= cider
$term= kitty
$mainMod = SUPER
$mainMod = SUPER
$soundsDir = ~/dotfiles/share/sounds/
$scriptsDir = ~/dotfiles/share/scripts/


# █░░░█ ▄▀▄ █░░ █░░ █▀▄ ▄▀▄ █▀▄ █▀▀ █▀▀▄ 
# █░█░█ █▀█ █░▄ █░▄ █░█ █▀█ █░█ █▀▀ █▐█▀ 
# ░▀░▀░ ▀░▀ ▀▀▀ ▀▀▀ █▀░ ▀░▀ █▀░ ▀▀▀ ▀░▀▀ 
# ----------------------------------------
$wallpaperDir = ~/dotfiles/share/wallpapers
$wallpaperOptions ="--loop --gamma=-5 --contrast=88 --saturation=79 --brightness=1 --mute=yes --video-unscaled=no --panscan=1"
$wallpaperFile = "yellowmatrix.mp4" ;just a nun embezzled in matrix code
$wallpaperHDR = "--vo=gpu-next --target-colorspace-hint --gpu-api=vulkan --gpu-context=waylandvk" ; experimental
$GstreamerOptions = "no-audio loop brightness=0.1 contrast=0.88 saturation=0.69 gamma=0.8" ; experimental, not working as v1.0.0-1 

exec= killall mpvpaper gslapper
exec= mpvpaper -o $wallpaperOptions DP-2 $wallpaperDir/$wallpaperFile
#exec= linux-wallpaperengine 3299228616 ;experimental
#exec= gslapper -vs -o $GstreamerOptions DP-2 $wallpaperDir/$wallpaperFile  ;experimental, not working as v1.0.0-1 

# █▀▄ ▀ █▄░█ █▀▄ ▄▀▀ 
# █▀█ █ █░▀█ █░█ ░▀▄ 
# ▀▀░ ▀ ▀░░▀ ▀▀░ ▀▀░ 
# ----------------------------------------

# SCREENSHOT
bind = , F7, exec, flameshot full --clipboard --path ~/Imágenes/Screenshots/ss_$(date +%Y-%m-%d_%H-%M_%S)_garuda.jpeg ;Screenshot fullscreen
bind= $mainMod, F7, exec, flameshot gui --clipboard --path ~/Imágenes/Screenshots/ss_$(date +%Y-%m-%d_%H-%M_%S)_garuda.jpeg ;Screenshot partial
bind= $mainMod Control_R, F7, exec, flameshot full --clipboard --path ~/Imágenes/Screenshots/ss_$(date +%Y-%m-%d_%H-%M_%S)_garuda.png ;Screenshot partial PNG

bind= $mainMod ,W,exec, pkill -SIGUSR1 waybar && pgrep dynisland >/dev/null && dynisland kill || dynisland daemon #Toggle hide/show waybar + dynisland

# ddccontrol monitor Brightnesss-------------------
bindr = , F1, exec, ddccontrol -r 0x10 -W -10 dev:/dev/i2c-11 &&  osd-client --brightness lower
bindr = , F2, exec, ddccontrol -r 0x10 -W 10 dev:/dev/i2c-11 && swayosd-client --brightness raise

bindr = $mainMod CTRL_R, F1, exec, ddccontrol -r 0x10 -w 40 dev:/dev/i2c-11 && swayosd-client --brightness lower & hyprshade toggle blue-light-filter
bindr = $mainMod CTRL_R, F2, exec, ddccontrol -r 0x10 -w 100 dev:/dev/i2c-11 && swayosd-client --brightness raise &  hyprshade toggle blue-light-filter

# volume control OSD------------------------------------
binde = , xf86audioraisevolume, exec, swayosd-client --output-volume raise
binde = , xf86audiolowervolume, exec, swa yosd-client --output-volume lower
bind = , XF86AudioMute, exec, swayosd-client --output-volume mute-toggle
bindr = , KEY_CAPSLOCK, exec, swayosd-client --caps-lock
#bindr= ALT,Alt_L, exec, swayos-clientd --caps-lock
#bind= KEY_CAPSLOCK,l, exec, $test

# 
binde = $mainMod SHIFT, right, resizeactive, 100 0# Increase window width 
binde = $mainMod SHIFT, left, resizeactive, -100 0# Reduce window width 
binde = $mainMod SHIFT, down, resizeactive, 0 100# Increase window height 
binde = $mainMod SHIFT, up, resizeactive, 0 -100# Reduce window height    

# Move window with mainMod + shift + arrow keys
bind = $mainMod CTRL SHIFT, left, movewindow, l
bind = $mainMod CTRL SHIFT, right, movewindow, r
bind = $mainMod CTRL SHIFT, up, movewindow, u
bind = $mainMod CTRL SHIFT, down, movewindow, d

# Move active window to a workspace with mainMod + SHIFT + [0-9]
bind = ALT, 1, movetoworkspacesilent, 1
bind = ALT, 2, movetoworkspacesilent, 2
bind = ALT, 3, movetoworkspacesilent, 3
bind = ALT, 4, movetoworkspacesilent, 4
bind = ALT, 5, movetoworkspacesilent, 5
bind = ALT, 6, movetoworkspacesilent, 6
bind = ALT, 7, movetoworkspacesilent, 7
bind = ALT, 8, movetoworkspacesilent, 8
bind = ALT, 9, movetoworkspacesilent, 9
bind = ALT, 0, movetoworkspacesilent, 10

bind= $mainMod CTRL,right,exec, hyprctl dispatch workspace e+1 ; play -v 0.1 "$soundsDir/gravity/change_workspace.wav"
bind= $mainMod CTRL,left,exec, hyprctl dispatch workspace e-1 ; play -v 0.1 "$soundsDir/gravity/change_workspace.wav"

# Scratchpad
bind= ALT,bar,movetoworkspacesilent,special
bindr = $mainMod, $mainMod_L, togglespecialworkspace,

#█▀▀▄ █░█ █░░ █▀▀ ▄▀▀ 
#█▐█▀ █░█ █░▄ █▀▀ ░▀▄ 
#▀░▀▀ ░▀░ ▀▀▀ ▀▀▀ ▀▀░ 
# ----------------------------------------
# windowrule= opacity 0.85 0.85,dolphin
windowrule= opacity 0.6 0.1, class:Calculator
windowrule= opacity 0.40 0.20, class:org.gnome.Calculator
windowrule= opacity 0.75 0.75,class:org.kde.dolphin
windowrule= opacity 0.55 0.55,class:$browser
windowrule= opacity 0.99 0.55,class:brave
windowrule= opacity 0.85 0.75,class:$term
windowrule= opacity 0.90 0.90,class:thunar
windowrule= opacity 0.70 0.50,class:whatsapp-for-linux
windowrule= opacity 0.80 0.80,class:whatsie
windowrule= opacity 0.85 0.85,class:whatsapp-nativefier
windowrule= opacity 0.85 0.85,class:com.rtosta.zapzap
windowrule= opacity 0.75 0.65,class:wasistlos
windowrule= opacity 0.85 0.85,class:discord
windowrule= opacity 0.55 0.55,class:GSK_RENDERER=gl DEBUG=1 easyeffects
windowrule= opacity 0.85 0.85,class:nz.co.mega.megasync
windowrule= opacity 0.90 0.90,class:pavucontrol
windowrule= opacity 0.55 0.33,class:ktimer
windowrule= opacity 0.25 0.11,class:konsole
windowrule= opacity 0.80 0.80,class:tidal-hifi
windowrule= opacity 0.80 0.70,class:code-oss
windowrule= opacity 0.90 0.75,class:code
windowrule= opacity 0.35 0.35,title:^(Genymotion)$
windowrule= opacity 0.35 0.35,class:^(nz.co.mega.megasync)$
windowrule= opacity 0.80 0.70,class:MEGAsync
windowrule= opacity 0.95 0.85,class:Spotify
windowrule= opacity 0.80 0.80,class:qdirstat
windowrule= opacity 0.80 0.80,class:qBittorrent
windowrule= opacity 0.99 0.99,class:steam_app_*3 # Path of exile
windowrule = opacity 0.5 0.6, class:^(awakened-poe-trade)$
windowrule = opacity 0.9 0.6, class:^([Rr]ofi)$
windowrule = opacity 0.9 0.6, class:^([Ss]afe[Ee]yes)$

# Updates
#windowrule = move 2 738, class:^(*dotfiles-floating*)$
windowrule = move 2 738, class:dotfiles-floating

# Calculator
windowrule = float, class:^(*org.kde.kalk*)$
windowrule = opacity 0.35 0.25, class:kalk
windowrule = size 150 276, class:^(org.kde.kalk)$
windowrule = move 2141 121, class:^(org.kde.kalk)$

# Gnome Calculator
#windowrulev2 = float, move 2458 61, class:^(org.gnome.Calculator)$
windowrule = float, size 700 380, move 990 990, class:org.gnome.Calculator
#windowrule = size 380 616, class:^(org.gnome.Calculator)$
#windowrule = size 400 650, class:^(org.gnome.Calculator)$
#windowrule = move 2458 61, class:^(org.gnome.Calculator)$

# Browser Picture in Picture
windowrule = float, title:^(Picture-in-Picture)$
windowrule = pin, title:^(Picture-in-Picture)$
#windowrule = move 69.67% 59.1%, title:^(Picture-in-Picture)$
#windowrule = move 2455 885, title:^(Picture-in-Picture)$
windowrule = move 0 885, title:^(Picture-in-Picture)$
windowrule = size 982 553, title:^(Picture-in-Picture)$

# Browser Spotify's mini player:
windowrule = float, class:^(Chromium-browser)$
windowrule = pin, class:^(Chromium-browser)$
windowrule = move 2159 -8, class:^(Chromium-browser)$
windowrule = noborder, class:Chromium-browser
windowrule = opacity 0.95 0.95, class:Chromium-browser
windowrule = rounding 40, class:Chromium-browser
windowrule = size 625 56, class:Chromium-browser
#windowrule = General:col.inactive_border 0, class:Chromium-browser
windowrule = noborder, class:zen

# dynisland
windowrule = noborder, class:^(dynisland-daemon)$
windowrule = noborder, class:^(dynisland)$
windowrule = noborder, class:dynisland
windowrule = noborder, title:dynisland
#windowrule = float, class:dynisland
#windowrule = opacity 0.75 0.75, class:dynisland
#windowrule = size 420 698, class:dynisland
#windowrule = move 2345 49, class:dynisland
windowrule = move 3345 49, class:dynisland

# Browser Bitwarden
windowrule = float,title:(Extensi.*)
windowrule = float,title:(.*Bitwarden.*)

windowrule = size 420 698, title:^(.*Bitwarden.*)$
windowrule = move 2345 49, title:^(.*Bitwarden.*)$

windowrule = opacity 0.79 0.75, class:$music

# Application Not Responding (wait or terminate) size: 436,189...at: 2980,60 size: 537,189
windowrule = move 2900 60, class:^(hyprland-dialog)$

# Unlock Keyring at: 1387,642 size: 666,155
#windowrule = move 2900 250, class:^(gcr-prompter)$

# Steam special offers size:706,830, at: 937,329
windowrule = move 937 60, title:^(.*Special Offers:.*)$

# Vscode dialog "Open File:"
windowrule = float,title:(Open File)

# Copiando — Dolphin: at: 1518,622	size: 404,196
#windowrule = move 1518,622, title:^(.*Copiando — Dolphin*)$
# El archivo ya existe — Dolphin: at: 1479,675 size: 610,138
#   windowrule = move 1479,819, title:^(.*El archivo ya existe — Dolphin*)$

#▄▀▀ █▀▄ ▄▀▄ █░░░█ █▄░█ 
#░▀▄ █░█ █▀█ █░█░█ █░▀█ 
#▀▀░ █▀░ ▀░▀ ░▀░▀░ ▀░░▀ 
# ----------------------------------------

# Spawn scratchpad terminals:
exec-once= [workspace special silent] easyeffects
exec-once = bash -c "sleep 15s && hyprctl dispatch exec '[workspace special silent] tidal-hifi'"
exec-once = bash -c "sleep 15s && hyprctl dispatch exec '[workspace special silent] $music'"
exec-once= [workspace special silent] $term -e -o font_size=10 btop
# exec-once= [workspace special silent] $term -e glava
# exec-once = [workspace special silent] kitty --title cava -e cava

# exec-once= [workspace 1 silent] $term hollywood ;too much cpu :'(

windowrule= workspace 1 silent, class:^(wasistlos)$
#exec-once= hyprctl dispatch exec [workspace 2 silent] 'foot --title garuda-update garuda-update'
exec-once= [workspace 3 silent] $files
exec-once= [workspace 5 silent] copyq
exec-once= [workspace 5 silent] ksnip
exec-once= [workspace 5 silent] corectrl
exec-once= [workspace 6 silent] megasync
#exec-once= [workspace 6 silent] qbittorrent

# Opens browser and whatsapp with a delay because it boots god damn fast! internet connection has to catch up! lol
exec-once = bash -c "sleep 15s && hyprctl dispatch exec '[workspace special silent] steam'"
exec-once = sleep 20s && hyprctl dispatch movetoworkspacesilent 1, class:steam
exec-once= hyprctl dispatch workspace 2
exec-once= sleep 10s && hyprctl dispatch exec "[workspace 1 silent]" QT_QUICK_BACKEND=software $whatsapp 
exec-once= sleep 7s && hyprctl dispatch exec "[workspace 2 silent]" $browser
#exec-once= sleep 10s && hyprctl dispatch exec "[workspace 2 silent]" code
#exec-once= [workspace 2 silent] code
#exec-once = [workspace 2 silent] sleep 3 && code
exec-once = sleep 3s && hyprctl dispatch exec "[workspace 2 silent]" code
exec-once = sleep 20s && dynisland daemon ; the cute bar on the top left for music visualitation


#▀█▀ █▀▀ ▄▀▀ ▀█▀ ▀ █▄░█ ▄▀▀░ 
#░█░ █▀▀ ░▀▄ ░█░ █ █░▀█ █░▀▌ 
#░▀░ ▀▀▀ ▀▀░ ░▀░ ▀ ▀░░▀ ▀▀▀░ 
# ----------------------------------------
exec-once = l-paste --type text --watch cliphist store # clipboard store text data
# exec-once = wl-paste --type image --watch cliphist store # clipboard store image data

#exec= sudo mkdir -p /run/media/n30/nvme_chivos/ && sudo mount /dev/nvme0n1p4 /run/media/n30/nvme_chivos/

exec = rclone mount "koofr:/koofr/Autosync" /home/n30/Autosync/ --vfs-cache-mode full && disown

exec-once = swayosd-server
exec = ddccontrol -r 0x10 -w 100 dev:/dev/i2c-110

# notification toggle
bind = $mainMod, N, exec, swaync-client -t -sw
exec-once = swaync

# lock session
bind = SUPER, L, exec, $scriptsDir/screenlock.sh 

# kill mpvpaper
bind = $mainMod CTRL ALT, W, exec, killall mpvpaper

windowrulev2 = opacity 0.80, class:^(com.mitchellh.ghostty)$

# Variables para D-Bus y notificaciones (requeridas en Wayland puro)
env = DBUS_SESSION_BUS_ADDRESS,unix:path=$XDG_RUNTIME_DIR/bus
env = NOTIFY_SOCKET,$XDG_RUNTIME_DIR/swaync.sock
env = GNOME_DESKTOP_SESSION_ID,none
#env = TIDAL_DISABLE_NOTIFICATIONS,1

# Zoom
bind = $mainMod CTRLx, mouse_down, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor -j | jq '.float * 1.1')
bind = $mainMod, mouse_up, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor -j | jq '(.float * 0.9) | if . < 1 then 1 else . end')

binde = $mainMod, equal, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor -j | jq '.float * 1.1')
binde = $mainMod, minus, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor -j | jq '(.float * 0.9) | if . < 1 then 1 else . end')
binde = $mainMod, KP_ADD, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor -j | jq '.float * 1.1')
binde = $mainMod, KP_SUBTRACT, exec, hyprctl -q keyword cursor:zoom_factor $(hyprctl getoption cursor:zoom_factor -j | jq '(.float * 0.9) | if . < 1 then 1 else . end')

bind = $mainMod SHIFT, mouse_up, exec, hyprctl -q keyword cursor:zoom_factor 1
bind = $mainMod SHIFT, mouse_down, exec, hyprctl -q keyword cursor:zoom_factor 1
bind = $mainMod SHIFT, minus, exec, hyprctl -q keyword cursor:zoom_factor 1
bind = $mainMod SHIFT, KP_SUBTRACT, exec, hyprctl -q keyword cursor:zoom_factor 1
bind = $mainMod SHIFT, 0, exec, hyprctl -q keyword cursor:zoom_factor 1

# GAME MODE
exec = $HOME/dotfiles/share/scripts/auto-game-mode.sh &
exec-once = /home/n30/dotfiles/share/scripts/mangohud-song.sh &

# io.github.slgobinath.SafeEyes:
windowrule = float, class:io.github.slgobinath.SafeEyes
windowrule = pin, class:io.github.slgobinath.SafeEyes
windowrule = move 2159 50, class:io.github.slgobinath.SafeEyes
windowrule = noborder, class:io.github.slgobinath.SafeEyes
windowrule = opacity 0.85 0.85, class:io.github.slgobinath.SafeEyes
windowrule = rounding 40, class:io.github.slgobinath.SafeEyes
windowrule = size 625 106, class:io.github.slgobinath.SafeEyes